<!DOCTYPE html>
<html xml:lang="en" lang="en-us">

  <head>
  <meta charset="utf-8" />
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
  <meta name="description" content="" />

  <title>
    
      Render Action Attribute &middot; Hazzik's blog
    
  </title>

  <link href="http://gmpg.org/xfn/11" rel="profile">
  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/hyde.css">
  <link rel="stylesheet" href="/public/css/tags.css">
  <link rel="stylesheet" href="/public/css/social.css">
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">
  <link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
                                 <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
  <meta name="google-site-verification" content="47dSjgZrewzbFXAnLPznjg7c_FE_SuVbOT0IEKn6h64" />
</head>


  <body>

    <div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="tag-cloud">
      <a href="/tag/dot-net" class="set-1">.NET</a> <a href="/tag/asp-dot-net-mvc" class="set-2">ASP.NET MVC</a> <a href="/tag/best-practicies" class="set-1">Best practicies</a> <a href="/tag/blog" class="set-1">Blog</a> <a href="/tag/computed-properties" class="set-1">Computed Properties</a> <a href="/tag/dataannotations" class="set-1">DataAnnotations</a> <a href="/tag/decompiler" class="set-1">Decompiler</a> <a href="/tag/delegate" class="set-1">Delegate</a> <a href="/tag/drop-down-lists" class="set-1">Drop down lists</a> <a href="/tag/git" class="set-2">Git</a> <a href="/tag/git-alias" class="set-1">Git Alias</a> <a href="/tag/google" class="set-1">Google</a> <a href="/tag/google-apps-script" class="set-1">Google Apps Script</a> <a href="/tag/javascript" class="set-1">JavaScript</a> <a href="/tag/linq" class="set-1">LINQ</a> <a href="/tag/mvcextensions" class="set-1">MvcExtensions</a> <a href="/tag/nhibernate" class="set-5">NHibernate</a> <a href="/tag/persistent-tree" class="set-1">Persistent-Tree</a> <a href="/tag/renderaction" class="set-1">RenderAction</a> <a href="/tag/tree" class="set-1">Tree</a> <a href="/tag/tree-hierarchy" class="set-1">Tree-Hierarchy</a> <a href="/tag/tree-structures" class="set-1">Tree-Structures</a>
    </div>
    <div class="sidebar-about">

      <h1><a href="/">Hazzik's blog</a></h1>
      <p class="lead"><a href="/"></a></p>

    </div>

    <ul class="sidebar-nav">
      <li class="sidebar-nav-item">
        <a href="/">Home</a>
      </li>

      

      
      
            <li class="sidebar-nav-item">
              <a href="/about/">About</a>
            </li>
      
    </ul>
    <ul class="sidebar-social">
      <li class="sidebar-social-item"><a href="http://twitter.com/hazzik" rel="me" alt="Twitter"><i class="fa fa-twitter"></i></a></li>
      &middot;
      <li class="sidebar-social-item"><a href="http://github.com/hazzik" rel="me" alt="GitHub"><i class="fa fa-github"></i></a></li>
      &middot;
      <li class="sidebar-social-item"><a href="http://linkedin.com/in/hazzik" rel="me" alt="LinkedIn"><i class="fa fa-linkedin"></i></a></li>
      &middot;
      <li class="sidebar-social-item"><a href="http://stackoverflow.com/users/259946/hazzik/" rel="me" alt="StackOverflow"><i class="fa fa-stack-overflow"></i></a></li>
      &middot;
      <li class="sidebar-social-item"><a href="https://alexzaytsev.me/atom.xml" alt="Subscribe"><i class="fa fa-rss"></i></i></a></li>
    </ul>

    <p>&copy; 2013 &mdash; 2018. <br/> All rights reserved.</p>
  </div>
</div>


    <div class="content container">
      <div class="post hentry">
  <h1 class="post-title entry-title">
    <a href="http://github.com/hazzik/alexzaytsev.me/edit/master/_posts/2014-06-17-render-action-attribute.md"><i class="fa fa-edit"></i></a> Render Action Attribute
  </h1>
  <ul class="post-info">
    <li><i class="fa fa-calendar"></i><time datetime="2014-06-17T11:43:03+12:00" class="published"> 17 Jun 2014 </time></li>
    <li class="tags"><i class="fa fa-tags"></i> <a href="/tag/asp-dot-net-mvc" rel="tag">ASP.NET MVC</a>, <a href="/tag/dataannotations" rel="tag">DataAnnotations</a>, <a href="/tag/renderaction" rel="tag">RenderAction</a></li>
    <li><i class="fa fa-comments"></i> <a href="/2014/06/17/render-action-attribute/#disqus_thread" data-disqus-identifier="/2014/06/17/render-action-attribute/">0 comments</a></li>
  </ul>
  <div class="entry-content">
    <p>The purpose of this attribute is to be able to render action as an editor or display template for your form fields. First of all we will need the data structure which will hold options for the our editor template.</p>

<h4>RenderActionOptions.cs</h4>
<div class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="k">public</span> <span class="k">class</span> <span class="nc">RenderActionOptions</span> 
<span class="p">{</span>
    <span class="k">public</span> <span class="k">static</span> <span class="kt">string</span> <span class="n">MetadataKey</span> <span class="p">=</span> <span class="s">"RenderActionOptions"</span><span class="p">;</span>

    <span class="k">public</span> <span class="kt">string</span> <span class="n">Action</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="n">Controller</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="n">Area</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Then we can use custom attribute, which implements <a href="http://msdn.microsoft.com/en-us/library/system.web.mvc.imetadataaware">IMetadataAware</a> interface, to fill the options and pass them to a metadata.</p>

<h4>RenderActionAttribute.cs</h4>
<div class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="k">public</span> <span class="k">class</span> <span class="nc">RenderActionAttribute</span> <span class="p">:</span> <span class="n">Attribute</span><span class="p">,</span> <span class="n">IMetadataAware</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="nf">RenderActionAttribute</span><span class="p">([</span><span class="n">AspMvcAction</span><span class="p">]</span> <span class="kt">string</span> <span class="n">action</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Action</span> <span class="p">=</span> <span class="n">action</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="nf">RenderActionAttribute</span><span class="p">([</span><span class="n">AspMvcAction</span><span class="p">]</span> <span class="kt">string</span> <span class="n">action</span><span class="p">,</span> <span class="p">[</span><span class="n">AspMvcController</span><span class="p">]</span> <span class="kt">string</span> <span class="n">controller</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Action</span> <span class="p">=</span> <span class="n">action</span><span class="p">;</span>
        <span class="n">Controller</span> <span class="p">=</span> <span class="n">controller</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="nf">RenderActionAttribute</span><span class="p">([</span><span class="n">AspMvcAction</span><span class="p">]</span> <span class="kt">string</span> <span class="n">action</span><span class="p">,</span> <span class="p">[</span><span class="n">AspMvcController</span><span class="p">]</span> <span class="kt">string</span> <span class="n">controller</span><span class="p">,</span> <span class="p">[</span><span class="n">AspMvcController</span><span class="p">]</span> <span class="kt">string</span> <span class="n">area</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Action</span> <span class="p">=</span> <span class="n">action</span><span class="p">;</span>
        <span class="n">Controller</span> <span class="p">=</span> <span class="n">controller</span><span class="p">;</span>
        <span class="n">Area</span> <span class="p">=</span> <span class="n">area</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="kt">string</span> <span class="n">Action</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="n">Controller</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="n">Area</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

    <span class="k">public</span> <span class="k">void</span> <span class="nf">OnMetadataCreated</span><span class="p">(</span><span class="n">ModelMetadata</span> <span class="n">metadata</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">metadata</span><span class="p">.</span><span class="n">AdditionalValues</span><span class="p">[</span><span class="n">RenderActionOptions</span><span class="p">.</span><span class="n">MetadataKey</span><span class="p">]</span> <span class="p">=</span> <span class="k">new</span> <span class="n">RenderActionOptions</span>
        <span class="p">{</span>
            <span class="n">Action</span> <span class="p">=</span> <span class="n">Action</span><span class="p">,</span>
            <span class="n">Controller</span> <span class="p">=</span> <span class="n">Controller</span><span class="p">,</span>
            <span class="n">Area</span> <span class="p">=</span> <span class="n">Area</span>
        <span class="p">};</span>
        <span class="n">metadata</span><span class="p">.</span><span class="n">TemplateHint</span> <span class="p">=</span> <span class="s">"RenderAction"</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>And finally at our EditorTemplate we will retrieve the options from the metadata and use <code>Html.RenderAction</code> helper method to render our action. Please note, that <code>Html.RenderAction</code> nor <code>Html.Action</code> do not accept &quot;area&quot; as an argument, so we need to add the &quot;area&quot; key to our routes dictionary. Also, we pass <code>data</code> to the <code>Html.RenderAction</code> method to be able supply some additional information/metadata to the rendered action.</p>

<h4>Shared/EditorTemplates/RenderAction.cshtml</h4>
<div class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="err">@</span><span class="p">{</span>
    <span class="n">var</span> <span class="n">data</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">RouteValueDictionary</span><span class="p">(</span><span class="n">ViewData</span><span class="p">);</span>
    <span class="kt">object</span> <span class="n">o</span><span class="p">;</span>
    <span class="n">ViewData</span><span class="p">.</span><span class="n">ModelMetadata</span><span class="p">.</span><span class="n">AdditionalValues</span><span class="p">.</span><span class="nf">TryGetValue</span><span class="p">(</span><span class="n">RenderActionOptions</span><span class="p">.</span><span class="n">MetadataKey</span><span class="p">,</span> <span class="k">out</span> <span class="n">o</span><span class="p">);</span>
    <span class="n">var</span> <span class="n">options</span> <span class="p">=</span> <span class="n">o</span> <span class="k">as</span> <span class="n">RenderActionOptions</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(!</span><span class="kt">string</span><span class="p">.</span><span class="nf">IsNullOrEmpty</span><span class="p">(</span><span class="n">options</span><span class="p">.</span><span class="n">Area</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="n">data</span><span class="p">[</span><span class="s">"area"</span><span class="p">]</span> <span class="p">=</span> <span class="n">options</span><span class="p">.</span><span class="n">Area</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(!</span><span class="kt">string</span><span class="p">.</span><span class="nf">IsNullOrEmpty</span><span class="p">(</span><span class="n">options</span><span class="p">.</span><span class="n">Controller</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="n">Html</span><span class="p">.</span><span class="nf">RenderAction</span><span class="p">(</span><span class="n">options</span><span class="p">.</span><span class="n">Action</span><span class="p">,</span> <span class="n">options</span><span class="p">.</span><span class="n">Controller</span><span class="p">,</span> <span class="n">data</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
        <span class="n">Html</span><span class="p">.</span><span class="nf">RenderAction</span><span class="p">(</span><span class="n">options</span><span class="p">.</span><span class="n">Action</span><span class="p">,</span> <span class="n">data</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h2>Example of Usage</h2>

<h4>MyModel.cs</h4>
<div class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="k">public</span> <span class="k">class</span> <span class="nc">MyModel</span> 
<span class="p">{</span>
    <span class="p">[</span><span class="nf">Display</span><span class="p">(</span><span class="n">Name</span> <span class="p">=</span> <span class="s">"City"</span><span class="p">),</span> <span class="nf">RenderAction</span><span class="p">(</span><span class="s">"ListCities"</span><span class="p">,</span> <span class="s">"Cities"</span><span class="p">)]</span>
    <span class="k">public</span> <span class="kt">int</span> <span class="n">CityId</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h4>MyForm.cshtml</h4>
<div class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="n">@model</span> <span class="n">MyModel</span>
<span class="c1">// ...
</span><span class="n">@Html</span><span class="p">.</span><span class="nf">EditorFor</span><span class="p">(</span><span class="n">m</span> <span class="p">=&gt;</span> <span class="n">m</span><span class="p">.</span><span class="n">CityId</span><span class="p">,</span> <span class="k">new</span> <span class="p">{</span> <span class="n">htmlAttributes</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span> <span class="n">@class</span> <span class="p">=</span> <span class="s">"my-editor"</span> <span class="p">}</span> <span class="p">}</span> <span class="p">)</span>
<span class="c1">// ...
</span></code></pre></div>
  </div>
</div>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- alexzaytsev.me -->
<ins class="adsbygoogle"
     style="display:inline-block;width:728px;height:15px"
     data-ad-client="ca-pub-6286543550478332"
     data-ad-slot="7799059444"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

  <div id="disqus_thread"></div>
  <script type="text/javascript">
      /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'hazzik-blog-en'; // required: replace example with your forum shortname
      var disqus_identifier = '/2014/06/17/render-action-attribute/';
      /* * * DON'T EDIT BELOW THIS LINE * * */
      (function() {
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
          dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


<div class="related">
  <h2>Related Posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/2015/01/20/nhibernate-4-0-3-released/">
            NHibernate 4.0.3 Released
            <small>20 Jan 2015</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2014/11/16/nhibernate-4-0-2-released/">
            NHibernate 4.0.2 Released
            <small>16 Nov 2014</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2014/11/10/playing-with-google-apps-script/">
            Playing with Google Apps Scripts
            <small>10 Nov 2014</small>
          </a>
        </h3>
      </li>
    
  </ul>
</div>

    </div>
<script type="text/javascript">
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
var disqus_shortname = 'hazzik-blog-en'; // required: replace example with your forum shortname

/* * * DON'T EDIT BELOW THIS LINE * * */
(function () {
var s = document.createElement('script'); 
s.async = true;
s.type = 'text/javascript';
s.src = '//' + disqus_shortname + '.disqus.com/count.js';
(document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
}());
</script>

<!-- Yandex.Metrika counter -->
<script src="//mc.yandex.ru/metrika/watch.js" type="text/javascript"></script>
<script type="text/javascript">
try { var yaCounter25093751 = new Ya.Metrika({id:25093751,
          webvisor:true,
          clickmap:true,
          trackLinks:true,
          accurateTrackBounce:true});
} catch(e) { }
</script>
<noscript><div><img src="//mc.yandex.ru/watch/25093751" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->

  </body>
</html>
